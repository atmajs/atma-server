include
	.inject('/src/HttpService/utils.js')
	.done(function(){
		
		function checkObject(a, b) {
			
			return service_validateArgs({
				body: a
			}, b);
		}
		
		UTest({
			
			'check object': function(){
				
				var error,
					expect = {
						username: 'string',
						password: 'string',
						'?age': 'number',
						'?joker': {
							'x_joker': 'number',
							'?y_joker': 'number'
						}
					};
				
				error = checkObject({
					username: 'foo',
					password: 'baz'
				}, expect);
				eq_(error, null);
				
				'> miss property'
				error = checkObject({
					username: 'foo'
				}, expect);
				has_(error, 'password');
				
				'> type missmatch'
				error = checkObject({
					username: 20,
					password: 'baz'
				}, expect);
				has_(error, 'username');
				
				error = checkObject({
					username: 'foo',
					password: 'baz',
					age: 'qux'
				}, expect);
				has_(error, 'age');
				
				
				'> miss subproperty'
				error = checkObject({
					username: 'foo',
					password: 'baz',
					joker: {} 
				}, expect);
				has_(error, 'x_joker');
				
				error = checkObject({
					username: 'foo',
					password: 'baz',
					joker: {
						x_joker: 'hello'
					} 
				}, expect);
				has_(error, 'x_joker');
				
				'> invalid optional subproperty type'
				error = checkObject({
					username: 'foo',
					password: 'baz',
					joker: {
						x_joker: 5,
						y_joker: 'baz'
					} 
				}, expect);
				has_(error, 'y_joker');
				
				'> valid'
				error = checkObject({
					username: 'foo',
					password: 'baz',
					joker: {
						x_joker: 5,
						y_joker: 7
					} 
				}, expect);
				eq_(error, null);
				
				'> array property: valid'
				expect = {
					collection: [ {_id: 'string'}]
				}
				error = checkObject({
					collection: [
						{ _id: '4343' },
						{ _id: '4343' },
						{ _id: '4343' },
					]
				}, expect);
				eq_(error, null);
				
				'> array property: invalid'
				error = checkObject({
					collection: [
						{ _id: '4343' },
						{ _id: '4343' },
						{ _id: 4343 },
					]
				}, expect);
				has_(error, '_id');
				
				'> array'
				expect = [ {_id: 'string' }]
				error = checkObject([
					{ _id: '4343' },
					{ _id: '4343' },
				], expect);
				eq_(error, null);
				
				
				'> regexp - valid'
				expect = { rgx: /^\w+$/ }
				error = checkObject({
					rgx: 'asd92'
				}, expect);
				eq_(error, null);
				
				'> regexp - invalid'
				expect = { rgx: /^\w+$/ }
				error = checkObject({
					rgx: 'as-d92'
				}, expect);
				has_(error, 'rgx');
			}
			
		})
	})